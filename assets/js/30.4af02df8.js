(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{396:function(e,t,s){"use strict";s.r(t);var a=s(45),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"webpack-to-vite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-to-vite"}},[e._v("#")]),e._v(" webpack-to-vite")]),e._v(" "),s("p",[e._v("将 webpack 项目转换为 vite 项目")]),e._v(" "),s("h2",{attrs:{id:"快速开始"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速开始"}},[e._v("#")]),e._v(" 快速开始")]),e._v(" "),s("ol",[s("li",[e._v("下载")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git clone https://github.com/originjs/webpack-to-vite.git\ncd webpack-to-vite\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("安装")])]),e._v(" "),s("p",[e._v("使用 npm, 运行")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("npm install\nnpm run build\n")])])]),s("p",[e._v("使用 yarn, 运行")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yarn\nyarn build\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[e._v("转换")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("node ./bin/index -d <project path>\n")])])]),s("h2",{attrs:{id:"演示项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#演示项目"}},[e._v("#")]),e._v(" 演示项目")]),e._v(" "),s("p",[e._v("以下是使用工具成功从 webpack 项目转换为 vite 项目的项目列表")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-vue2",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-vue2"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-vue3",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-vue3"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-webpack",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-webpack"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-manage-system-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/newbee-mall-vue3-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-realworld-example-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-uploader-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/douban-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"成功转换的项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#成功转换的项目"}},[e._v("#")]),e._v(" 成功转换的项目")]),e._v(" "),s("h3",{attrs:{id:"vue-cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli"}},[e._v("#")]),e._v(" vue-cli")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/lin-xin/vue-manage-system",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-manage-system-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/newbee-ltd/newbee-mall-vue3-app",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/newbee-mall-vue3-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-realworld-example-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h3",{attrs:{id:"webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[e._v("#")]),e._v(" webpack")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/simple-uploader/vue-uploader",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-uploader-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/jeneser/douban",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/douban-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"转换项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#转换项"}},[e._v("#")]),e._v(" 转换项")]),e._v(" "),s("p",[e._v("以下是需要转换的配置项列表")]),e._v(" "),s("p",[e._v("图例注解：")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("图例")]),e._v(" "),s("th",[e._v("描述")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("✅")]),e._v(" "),s("td",[e._v("通过 "),s("code",[e._v("webpack-to-vite")]),e._v(" 自动转换")])]),e._v(" "),s("tr",[s("td",[e._v("⚠️")]),e._v(" "),s("td",[e._v("需要手动转换")])]),e._v(" "),s("tr",[s("td",[e._v("❌")]),e._v(" "),s("td",[e._v("目前不支持")])])])]),e._v(" "),s("h3",{attrs:{id:"基础转换项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础转换项"}},[e._v("#")]),e._v(" 基础转换项")]),e._v(" "),s("ul",[s("li",[e._v("✅ B01: 在 "),s("code",[e._v("package.json")]),e._v(" 中添加必要的 devDependencies 和 dependencies\n"),s("ul",[s("li",[e._v("必要的: "),s("code",[e._v("vite-plugin-env-compatible")]),e._v(", "),s("code",[e._v("vite-plugin-html")]),e._v(", "),s("code",[e._v("vite")]),e._v(",")]),e._v(" "),s("li",[e._v("Vue2 必要的: "),s("code",[e._v("vite-plugin-vue2")])]),e._v(" "),s("li",[e._v("Vue3 必要的: "),s("code",[e._v("@vue/compiler-sfc")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue-jsx")])])])]),e._v(" "),s("li",[e._v("✅ B02: 将 vite 入口文件 "),s("code",[e._v("index.html")]),e._v(" 添加到根目录\n"),s("ul",[s("li",[e._v("支持 "),s("code",[e._v("vue.config.js")]),e._v(" 中 "),s("code",[e._v("pages")]),e._v(" 选项定义的多个配置项")]),e._v(" "),s("li",[e._v("添加像这样的入口点："),s("code",[e._v('<script type="module" src="/src/main.js"><\/script>')]),e._v("，不需要添加 "),s("code",[e._v("dev-client")]),e._v(" 入口点，因为 vite 默认支持 HMR")])])]),e._v(" "),s("li",[e._v("✅ B03: 将 vite 配置文件 "),s("code",[e._v("vite.config.js")]),e._v(" 添加到根目录")]),e._v(" "),s("li",[e._v("✅ B04: 在 "),s("code",[e._v("vite.config.js")]),e._v(" 中导入和使用必要的插件\n"),s("ul",[s("li",[e._v("必要的 "),s("code",[e._v("vite-plugin-env-compatible")])]),e._v(" "),s("li",[e._v("Vue2 必要的: "),s("code",[e._v("vite-plugin-vue2")]),e._v("，通过 "),s("code",[e._v("{ jsx: true }")]),e._v(" 选项启用 "),s("code",[e._v("jsx")]),e._v(" 默认支持")]),e._v(" "),s("li",[e._v("Vue3 必要的: "),s("code",[e._v("@vitejs/plugin-vue")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue-jsx")])])])]),e._v(" "),s("li",[e._v("✅ B05: 支持省略 "),s("code",[e._v(".vue")]),e._v(" 扩展名的导入\n"),s("ul",[s("li",[e._v("在 "),s("code",[e._v("vite.config.js")]),e._v(" 中，设置 "),s("code",[e._v("resolve.extensions")]),e._v(" 配置项为 "),s("code",[e._v("['.mjs', '.js', '.ts', '.jsx', '.tsx', '.json', '.vue']")]),e._v('，\n然后你可能会遇到 "'),s("a",{attrs:{href:"https://github.com/vitejs/vite/issues/3532",target:"_blank",rel:"noopener noreferrer"}},[e._v("Problems caused by using alisaes and omitting file suffixes at the same time"),s("OutboundLink")],1),e._v('" 这样的问题，\n我们使用补丁来解决这个问题，以防万一 vite 不接受相关 PR')])])]),e._v(" "),s("li",[e._v("✅ B06: sass 支持\n"),s("ul",[s("li",[e._v("如果之前使用 "),s("code",[e._v("node-sass")]),e._v(" 依赖，则转换为 "),s("code",[e._v("sass")]),e._v(" 依赖")])])]),e._v(" "),s("li",[e._v("✅ B07: postcss 8 支持\n"),s("ul",[s("li",[e._v("如果之前使用 postcss 8，请添加 "),s("code",[e._v("postcss")]),e._v(" 依赖")])])]),e._v(" "),s("li",[e._v("⚠️ B08: 修复问题 '"),s("a",{attrs:{href:"https://github.com/vitejs/vite/issues/2117",target:"_blank",rel:"noopener noreferrer"}},[e._v("No matching export for import typescript interface"),s("OutboundLink")],1),e._v("'\n"),s("ul",[s("li",[e._v("请勿在 vite 中重复导出 typescript 类型或接口。 您只能在文件 A 中将其导出，然后在文件 B 中将其导入。不要尝试在文件 B 中将其再次导出。\n以下是重复导出类型或接口时出现的错误：")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Uncaught SyntaxError: The requested module '/src/app/reducers/state.ts' does not provide an export named 'RootState'\n")])])]),s("ul",[s("li",[e._v("只要删除 typescript 项目中所有重复导出的类型或接口，并修改相关导入路径")])])]),e._v(" "),s("li",[e._v("⚠️ B09: 删除模块热更新（或 HMR）相关代码，因为 vite 默认支持 HMR\n"),s("ul",[s("li",[e._v("项目包含 HMR 相关代码时出现以下错误：")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("index.tsx:6 Uncaught ReferenceError: module is not defined\n  at index.tsx:6\n")])])])]),e._v(" "),s("li",[e._v("⚠️ B10: CSS Modules\n"),s("ul",[s("li",[e._v("在 vite 中, 任何以 "),s("code",[e._v(".module.css")]),e._v(" 为后缀名的 CSS 文件都被认为是一个 CSS modules 文件")]),e._v(" "),s("li",[e._v("这意味着你需要将以 "),s("code",[e._v(".css")]),e._v(" 为后缀文件转换为以 "),s("code",[e._v(".module.css")]),e._v(" 为后缀的文件来实现 CSS Modules")]),e._v(" "),s("li",[e._v("⚠️ B11: 插件暴露的默认值")]),e._v(" "),s("li",[e._v("当 "),s("code",[e._v("index.html")]),e._v(" 包含 "),s("code",[e._v("htmlWebpackPlugin.options.variableName")]),e._v(" 时出现 "),s("code",[e._v("htmlWebpackPlugin is not defined")]),e._v(" 错误，需要在 "),s("code",[e._v("vite.config.js")]),e._v(" 中添加插件选项：")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("plugins: [\n  injectHtml:({\n    injectData: {\n      htmlWebpackPlugin: {\n        options: {\n          variableName: value\n        }\n      }\n    }\n  })\n]\n")])])])])]),e._v(" "),s("h3",{attrs:{id:"vue-cli-转换项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli-转换项"}},[e._v("#")]),e._v(" Vue-CLI 转换项")]),e._v(" "),s("blockquote",[s("p",[e._v("Vue-CLI转换是将"),s("code",[e._v("vue.config.js")]),e._v("中的配置，转换后设置到"),s("code",[e._v("vite.config.js")]),e._v("中")])]),e._v(" "),s("ul",[s("li",[s("p",[e._v("✅ V01: public path环境变量")])]),e._v(" "),s("li",[s("p",[s("code",[e._v("process.env.PUBLIC_URL")]),e._v(" 或 "),s("code",[e._v("publicPath")]),e._v(" 或 "),s("code",[e._v("baseUrl")]),e._v(" -> "),s("code",[e._v("base")])])]),e._v(" "),s("li",[s("p",[e._v("✅ V02: css配置")]),e._v(" "),s("ul",[s("li",[s("p",[s("code",[e._v("css.loaderOptions")]),e._v(" -> "),s("code",[e._v("css.preprocessorOptions")])])]),e._v(" "),s("li",[s("p",[s("code",[e._v("css.loaderOptions.less.lessOptions.modifyVars")]),e._v(" -> "),s("code",[e._v("css.preprocessorOptions.less.modifyVars")])])]),e._v(" "),s("li",[s("p",[e._v("如果在项目中对"),s("code",[e._v("css.loaderOptions.sass")]),e._v("进行了配置，则"),s("code",[e._v("css.preprocessorOptions.sass")]),e._v(" 和 "),s("code",[e._v("css.preprocessorOptions.sass")]),e._v("也会进行相应的转换。")]),e._v(" "),s("p",[e._v("在vue-cli中，"),s("code",[e._v("sass")]),e._v("配置可以同时影响"),s("code",[e._v("sass")]),e._v("和"),s("code",[e._v("scss")]),e._v("，而在vite中需要对它们进行单独配置")])])])]),e._v(" "),s("li",[s("p",[e._v("✅ V03: server配置")]),e._v(" "),s("ul",[s("li",[e._v("默认添加"),s("code",[e._v("server.strictPort = false")]),e._v("配置")]),e._v(" "),s("li",[s("code",[e._v("process.env.PORT")]),e._v(" 或 "),s("code",[e._v("devServer.port")]),e._v(" -> "),s("code",[e._v("server.port")])]),e._v(" "),s("li",[s("code",[e._v("process.env.DEV_HOST")]),e._v(" 或 "),s("code",[e._v("devServer.public")]),e._v(" 或 "),s("code",[e._v("devServer.host")]),e._v(" -> "),s("code",[e._v("server.host")]),e._v("，并将"),s("code",[e._v("http://")]),e._v(" 或"),s("code",[e._v("https://")]),e._v(" 替换为 "),s("code",[e._v("''")])]),e._v(" "),s("li",[s("code",[e._v("devServer.open")]),e._v(", "),s("code",[e._v("devServer.https")]),e._v(" -> "),s("code",[e._v("server.open")]),e._v(", "),s("code",[e._v("server.https")])]),e._v(" "),s("li",[s("code",[e._v("devServer.proxy")]),e._v(" -> "),s("code",[e._v("server.proxy")]),e._v(", 另外在proxy配置中，进行"),s("code",[e._v("pathRewrite")]),e._v(" -> "),s("code",[e._v("rewrite")]),e._v("转换")])])]),e._v(" "),s("li",[s("p",[e._v("✅ V04: build options")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("outputDir")]),e._v(" -> "),s("code",[e._v("build.outDir")])]),e._v(" "),s("li",[s("code",[e._v("css.extract")]),e._v(" -> "),s("code",[e._v("build.cssCodeSplit")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("process.env.MODERN === 'true'")]),e._v(", set "),s("code",[e._v("build.minify = esbuild")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("process.env.GENERATE_SOURCEMAP === 'true'")]),e._v(" or "),s("code",[e._v("vueConfig.productionSourceMap")]),e._v(" or "),s("code",[e._v("css.sourceMap")]),e._v(" -> "),s("code",[e._v("build.sourcemap")])])])]),e._v(" "),s("li",[s("p",[e._v("✅ V05: "),s("code",[e._v("resolve.alias")]),e._v(" options")]),e._v(" "),s("ul",[s("li",[e._v("add default alias options")])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("resolve"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/^~/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("ul",[s("li",[e._v("convert webpack alias options to match format above")])])]),e._v(" "),s("li",[s("p",[e._v("✅ V06: client-side env variables")]),e._v(" "),s("ul",[s("li",[e._v("extract variable names contained in jsp scriptlet tags")]),e._v(" "),s("li",[s("code",[e._v("VUE_APP_VARIABLE")]),e._v(" -> "),s("code",[e._v("process.env['VUE_APP_VARIABLE']")])])])])]),e._v(" "),s("h3",{attrs:{id:"webpack-转换项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-转换项"}},[e._v("#")]),e._v(" Webpack 转换项")]),e._v(" "),s("blockquote",[s("p",[e._v("Webpack conversion are base on "),s("code",[e._v("webpack.config.js")]),e._v(" or "),s("code",[e._v("webpack.base.js、webpack.dev.js、webpack.prod.js|webpack.build.js|webpack.production.js")]),e._v(", map configuration to "),s("code",[e._v("vite.config.js")])])]),e._v(" "),s("blockquote",[s("p",[e._v("Note: if you are not using configuration file above, you need to convert configuration manually instead using tool")])]),e._v(" "),s("ul",[s("li",[e._v("✅ W01: build input options\n"),s("ul",[s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("string")]),e._v(" type, "),s("code",[e._v("entry")]),e._v(" -> "),s("code",[e._v("build.rollupOptions.input")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("object")]),e._v(" type, convert each object property and each array element to "),s("code",[e._v("build.rollupOptions.input")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("function")]),e._v(" type, convert function execute result to "),s("code",[e._v("build.rollupOptions.input")])])])]),e._v(" "),s("li",[e._v("✅ W02: outDir options\n"),s("ul",[s("li",[s("code",[e._v("output.path")]),e._v(" -> "),s("code",[e._v("build.outDir")])])])]),e._v(" "),s("li",[e._v("✅ W03: "),s("code",[e._v("resolve.alias")]),e._v(" options\n"),s("ul",[s("li",[e._v("add default alias options")])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("resolve"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("ul",[s("li",[e._v("convert webpack alias options to match format above")]),e._v(" "),s("li",[s("code",[e._v("resolve.alias")]),e._v(" options key has trailing "),s("code",[e._v("$")]),e._v(", need to remove '$' and re-assign an exact path value")])])]),e._v(" "),s("li",[e._v("✅ W04: server options\n"),s("ul",[s("li",[s("code",[e._v("devServer.host")]),e._v(", "),s("code",[e._v("devServer.port")]),e._v(", "),s("code",[e._v("devServer.proxy")]),e._v(", "),s("code",[e._v("devServer.https")]),e._v(", "),s("code",[e._v("devServer.contentBase")]),e._v(" -> "),s("code",[e._v("server.host")]),e._v(", "),s("code",[e._v("server.port")]),e._v(", "),s("code",[e._v("server.proxy")]),e._v(", "),s("code",[e._v("server.https")]),e._v(", "),s("code",[e._v("server.base")])])])]),e._v(" "),s("li",[e._v("✅ W05: define options\n"),s("ul",[s("li",[s("code",[e._v("new webpack.DefinePlugin()")]),e._v(" -> "),s("code",[e._v("define")])])])])]),e._v(" "),s("h3",{attrs:{id:"其他转换项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他转换项"}},[e._v("#")]),e._v(" 其他转换项")]),e._v(" "),s("ul",[s("li",[e._v("⚠️ O01: use CommonJS syntax, e.g. "),s("code",[e._v("require('./')")]),e._v(" "),s("ul",[s("li",[e._v("add vite plugin "),s("code",[e._v("@originjs/vite-plugin-commonjs")]),e._v(", see detail: https://github.com/originjs/vite-plugins/tree/main/packages/vite-plugin-commonjs")]),e._v(" "),s("li",[e._v("plugin above support part of CommonJS syntax, still, some special syntax didn't support, recommend covert to ES Modules syntax")])])]),e._v(" "),s("li",[e._v("❌ O02: use ElementUI, see detail: https://github.com/vitejs/vite/issues/3370"),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(" [vite] Uncaught TypeError: Cannot read property '$isServer' of undefined\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/dom.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1189)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/popup/popup-manager.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1478)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/popup/index.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1701)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/vue-popper.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:2546)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at Object.5 (:8080/node_modules/.vite/element-ui.js?v=675d2c77:6861)\n  at __webpack_require__ (:8080/node_modules/.vite/element-ui.js?v=675d2c77:6547)\n")])])])]),e._v(" "),s("li",[e._v("⚠️ O03: css automatic imports\n"),s("ul",[s("li",[e._v("if use "),s("code",[e._v("style-resources-loader")]),e._v(" before, try to replace by "),s("code",[e._v("additionalData")]),e._v(". Example:")])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("pluginOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'style-resources-loader'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    preProcessor"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    patterns"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src/styles/var.less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src/styles/mixin.less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("css"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  preprocessorOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    less"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      additionalData"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("@import 'src/styles/var.less';")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")])]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("+")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("@import 'src/styles/mixin.less';")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")])]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])]),e._v(" "),s("li",[e._v("⚠️ O04: imports path include multiple alias like: "),s("code",[e._v("@import '~@/styles/global.scss'")]),e._v(", which is includes alias "),s("code",[e._v("~")]),e._v(" and "),s("code",[e._v("@")]),e._v(" "),s("ul",[s("li",[e._v("add an alias configure "),s("code",[e._v("{ find: /^~@/, replacement: path.resolve(__dirname, 'src') }")]),e._v(" to "),s("code",[e._v("resolve.alias")]),e._v(" options, and place it on first")])])]),e._v(" "),s("li",[e._v("⚠️ O05: use "),s("code",[e._v("jsx")]),e._v(" syntax in "),s("code",[e._v(".vue")]),e._v(" file\n"),s("ul",[s("li",[e._v("make sure enable "),s("code",[e._v("jsx")]),e._v(" support, Vue2 add plugin "),s("code",[e._v("vite-plugin-vue2")]),e._v(" and pass "),s("code",[e._v("{ jsx: true }")]),e._v(" option, Vue3 add plugin "),s("code",[e._v("@vitejs/plugin-vue-jsx")])]),e._v(" "),s("li",[e._v("add attribute "),s("code",[e._v('lang="jsx"')]),e._v(" to "),s("code",[e._v("script")]),e._v(" label, e.g. "),s("code",[e._v('<script lang="jsx"><\/script>')])]),e._v(" "),s("li",[e._v("If the following error occurs")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('3:54:29 PM [vite] Internal server error: /Users/Chieffo/Documents/project/Vue-mmPlayer/src/base/mm-icon/mm-icon.vue?vue&type=script&lang.tsx: Duplicate declaration "h" (This is an error on an internal node. Probably an internal error.)\nPlugin: vite-plugin-vue2\nFile: /Users/Chieffo/Documents/project/Vue-mmPlayer/src/base/mm-icon/mm-icon.vue?vue&type=script&lang.tsx\n    at File.buildCodeFrameError (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/core/lib/transformation/file/file.js:244:12)\n    at Scope.checkBlockScopedCollisions (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:421:22)\n    at Scope.registerBinding (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:581:16)\n    at Scope.registerDeclaration (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:523:14)\n    at Object.BlockScoped (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:240:12)\n    at Object.newFn (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/visitors.js:212:17)\n    at NodePath._call (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:53:20)\n    at NodePath.call (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:36:14)\n    at NodePath.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:90:31)\n    at TraversalContext.visitQueue (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:99:16)\n    at TraversalContext.visitMultiple (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:68:17)\n    at TraversalContext.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:125:19)\n    at Function.traverse.node (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/index.js:76:17)\n    at NodePath.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:97:18)\n    at TraversalContext.visitQueue (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:99:16)\n    at TraversalContext.visitSingle (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:73:19)\n')])])]),e._v("update config to "),s("code",[e._v("babel.config.js")]),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  presets"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@vue/app'")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  presets"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@vue/babel-preset-jsx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("see detail: https://vuejs.org/v2/guide/render-function.html#JSX")]),e._v(" "),s("li",[e._v("⚠️ O06: use webpack api "),s("code",[e._v("require.context")]),e._v(" "),s("ul",[s("li",[e._v("add vite plugin "),s("code",[e._v("@originjs/vite-plugin-require-context")]),e._v(", see detail: https://github.com/originjs/vite-plugins/tree/main/packages/vite-plugin-require-context")])])]),e._v(" "),s("li",[e._v("✅ O07: fix issue 'Compiling error when the template of the .vue file has the attribute lang=\"html\"'\n"),s("ul",[s("li",[e._v("remove "),s("code",[e._v('lang="html"')]),e._v(" attribute from "),s("code",[e._v("template")]),e._v(" label, see detail: https://github.com/vuejs/vue-loader/issues/1443")])])]),e._v(" "),s("li",[e._v("❌ O08: use webpack api "),s("code",[e._v("require.ensure")])]),e._v(" "),s("li",[e._v("⚠️ O09: convert dynamic imports that paths include alias to absolute path or relative path, see detail: see detail: https://github.com/rollup/plugins/tree/master/packages/dynamic-import-vars#limitations"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@/components/views/test.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./components/views/test.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])])])])])}),[],!1,null,null,null);t.default=r.exports}}]);