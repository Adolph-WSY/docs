(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{386:function(e,t,s){"use strict";s.r(t);var a=s(45),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"webpack-to-vite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-to-vite"}},[e._v("#")]),e._v(" webpack-to-vite")]),e._v(" "),s("p",[e._v("convert a webpack project to a vite project")]),e._v(" "),s("h2",{attrs:{id:"quick-start"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#quick-start"}},[e._v("#")]),e._v(" Quick Start")]),e._v(" "),s("ol",[s("li",[e._v("download")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("git clone https://github.com/originjs/webpack-to-vite.git\ncd webpack-to-vite\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("install")])]),e._v(" "),s("p",[e._v("with npm, run")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("npm install\nnpm run build\n")])])]),s("p",[e._v("with yarn, run")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yarn\nyarn build\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[e._v("convert")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("node ./bin/index -d <project path>\n")])])]),s("h2",{attrs:{id:"demos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#demos"}},[e._v("#")]),e._v(" Demos")]),e._v(" "),s("p",[e._v("The following is a list of projects that successfully converted from a webpack project to a vite project using the tool")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-vue2",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-vue2"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-vue3",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-vue3"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/helloworld-webpack",target:"_blank",rel:"noopener noreferrer"}},[e._v("helloworld-webpack"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-manage-system-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/newbee-mall-vue3-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-realworld-example-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-uploader-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/douban-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"awesome-projects-successfully-converted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#awesome-projects-successfully-converted"}},[e._v("#")]),e._v(" Awesome projects successfully converted")]),e._v(" "),s("h3",{attrs:{id:"vue-cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli"}},[e._v("#")]),e._v(" vue-cli")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/lin-xin/vue-manage-system",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-manage-system-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-manage-system-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/newbee-ltd/newbee-mall-vue3-app",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/newbee-mall-vue3-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("newbee-mall-vue3-app-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/gothinkster/vue-realworld-example-app",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-realworld-example-app-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-realworld-example-app-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h3",{attrs:{id:"webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[e._v("#")]),e._v(" webpack")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/simple-uploader/vue-uploader",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/vue-uploader-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("vue-uploader-vite"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/jeneser/douban",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban"),s("OutboundLink")],1),e._v(" -> "),s("a",{attrs:{href:"https://github.com/originjs/webpack-to-vite-demos/tree/main/douban-vite",target:"_blank",rel:"noopener noreferrer"}},[e._v("douban-vite"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"conversion-items"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#conversion-items"}},[e._v("#")]),e._v(" Conversion items")]),e._v(" "),s("p",[e._v("The following is a list of configuration items that need to convert")]),e._v(" "),s("p",[e._v("Legend of annotations:")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",[e._v("Mark")]),e._v(" "),s("th",[e._v("Description")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("✅")]),e._v(" "),s("td",[e._v("auto convert by "),s("code",[e._v("webpack-to-vite")])])]),e._v(" "),s("tr",[s("td",[e._v("⚠️")]),e._v(" "),s("td",[e._v("need manual convert")])]),e._v(" "),s("tr",[s("td",[e._v("❌")]),e._v(" "),s("td",[e._v("not support now")])])])]),e._v(" "),s("h3",{attrs:{id:"base-conversion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#base-conversion"}},[e._v("#")]),e._v(" Base conversion")]),e._v(" "),s("ul",[s("li",[e._v("✅ B01: add necessary devDependencies and dependencies in "),s("code",[e._v("package.json")]),e._v(" "),s("ul",[s("li",[e._v("necessary: "),s("code",[e._v("vite-plugin-env-compatible")]),e._v(", "),s("code",[e._v("vite-plugin-html")]),e._v(", "),s("code",[e._v("vite")]),e._v(",")]),e._v(" "),s("li",[e._v("necessary for Vue2: "),s("code",[e._v("vite-plugin-vue2")])]),e._v(" "),s("li",[e._v("necessary for Vue3: "),s("code",[e._v("@vue/compiler-sfc")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue-jsx")])])])]),e._v(" "),s("li",[e._v("✅ B02: add vite's entry file "),s("code",[e._v("index.html")]),e._v(" to root directory\n"),s("ul",[s("li",[e._v("multiple entries defined by the "),s("code",[e._v("pages")]),e._v(" option in "),s("code",[e._v("vue.config.js")]),e._v(" is supported")]),e._v(" "),s("li",[e._v("please add entry point like "),s("code",[e._v('<script type="module" src="/src/main.js"><\/script>')]),e._v(". There's no need to add "),s("code",[e._v("dev-client")]),e._v(" entry point cause vite supports HMR by default")])])]),e._v(" "),s("li",[e._v("✅ B03: add vite's config file "),s("code",[e._v("vite.config.js")]),e._v(" to root directory")]),e._v(" "),s("li",[e._v("✅ B04: import and use necessary plugins in "),s("code",[e._v("vite.config.js")]),e._v(" "),s("ul",[s("li",[e._v("necessary: "),s("code",[e._v("vite-plugin-env-compatible")])]),e._v(" "),s("li",[e._v("necessary for Vue2: "),s("code",[e._v("vite-plugin-vue2")]),e._v(", we set "),s("code",[e._v("{ jsx: true }")]),e._v(" option to enable "),s("code",[e._v("jsx")]),e._v(" support by default")]),e._v(" "),s("li",[e._v("necessary for Vue3: "),s("code",[e._v("@vitejs/plugin-vue")]),e._v(", "),s("code",[e._v("@vitejs/plugin-vue-jsx")])])])]),e._v(" "),s("li",[e._v("✅ B05: imports that omit "),s("code",[e._v(".vue")]),e._v(" extension is supported\n"),s("ul",[s("li",[e._v("If the "),s("code",[e._v("resolve.extensions")]),e._v(" is set to be "),s("code",[e._v("['.mjs','.js','.ts','.jsx','.tsx','.json ','.vue']")]),e._v(", in "),s("code",[e._v("vite.config.js")]),e._v(",\nthen you may encounter errors like '"),s("a",{attrs:{href:"https://github.com/vitejs/vite/issues/3532",target:"_blank",rel:"noopener noreferrer"}},[e._v("Problems caused by using alisaes and omitting file suffixes at the same time"),s("OutboundLink")],1),e._v("'.\nWe use a patch to fix this issue, in case of vite didn't accept relate PR")])])]),e._v(" "),s("li",[e._v("✅ B06: "),s("code",[e._v("sass")]),e._v(" is supported\n"),s("ul",[s("li",[e._v("if "),s("code",[e._v("node-sass")]),e._v(" is used in dependency, then we'll convert it to "),s("code",[e._v("sass")]),e._v(" to dependencies")])])]),e._v(" "),s("li",[e._v("✅ B07: "),s("code",[e._v("postcss 8")]),e._v(" is supported\n"),s("ul",[s("li",[e._v("if "),s("code",[e._v("postcss 8")]),e._v(" is used, then we'll add "),s("code",[e._v("postcss")]),e._v(" to dependencies")])])]),e._v(" "),s("li",[e._v("⚠️ B08: fix issue '"),s("a",{attrs:{href:"https://github.com/vitejs/vite/issues/2117",target:"_blank",rel:"noopener noreferrer"}},[e._v("No matching export for import typescript interface"),s("OutboundLink")],1),e._v("'\n"),s("ul",[s("li",[e._v("Do not re-export typescript type or interface in vite. You can just export it in file A and import it in file B. Don't try to export it in file B again.\nThe following error may occur if a type or a interface is re-exported:")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Uncaught SyntaxError: The requested module '/src/app/reducers/state.ts' does not provide an export named 'RootState'\n")])])]),s("ul",[s("li",[e._v("Just remove all re-export types or interfaces in typescript project and modify corresponding imports")])])]),e._v(" "),s("li",[e._v("⚠️ B09: remove "),s("code",[e._v("Hot Module Replacement")]),e._v("(aka HMR) related code because vite supports HMR by default.\n"),s("ul",[s("li",[e._v("The following error may occur when project contains HMR relate code:")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("index.tsx:6 Uncaught ReferenceError: module is not defined\n  at index.tsx:6\n")])])])]),e._v(" "),s("li",[e._v("⚠️ B10: CSS Modules\n"),s("ul",[s("li",[e._v("In vite, any CSS files ending with "),s("code",[e._v(".module.css")]),e._v(" is considered a CSS modules file")]),e._v(" "),s("li",[e._v("That means you need to covert files with extension of "),s("code",[e._v(".css")]),e._v(" to files with extension of "),s("code",[e._v(".module.css")]),e._v(" to implement CSS Modules")])])]),e._v(" "),s("li",[e._v("⚠️ B11: default values exposed by plugins\n"),s("ul",[s("li",[e._v("The error "),s("code",[e._v("htmlWebpackPlugin is not defined")]),e._v(" may occur if "),s("code",[e._v("index.html")]),e._v(" includes "),s("code",[e._v("htmlWebpackPlugin.options.variableName")]),e._v(". You need to add a plugin in "),s("code",[e._v("vite.config.js")]),e._v(" like this:")])]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n  injectHtml"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    injectData"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      htmlWebpackPlugin"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        options"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n          variableName"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" value\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])])])]),e._v(" "),s("h3",{attrs:{id:"vue-cli-conversion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-cli-conversion"}},[e._v("#")]),e._v(" Vue-CLI conversion")]),e._v(" "),s("blockquote",[s("p",[e._v("Vue-CLI conversion is based on "),s("code",[e._v("vue.config.js")]),e._v(". Configurations will be transformed and written to "),s("code",[e._v("vite.config.js")])])]),e._v(" "),s("ul",[s("li",[e._v("✅ V01: base public path\n"),s("ul",[s("li",[s("code",[e._v("process.env.PUBLIC_URL")]),e._v(" or "),s("code",[e._v("publicPath")]),e._v(" or "),s("code",[e._v("baseUrl")]),e._v(" -> "),s("code",[e._v("base")])])])]),e._v(" "),s("li",[e._v("✅ V02: css options\n"),s("ul",[s("li",[s("code",[e._v("css.loaderOptions")]),e._v(" -> "),s("code",[e._v("css.preprocessorOptions")])]),e._v(" "),s("li",[s("code",[e._v("css.loaderOptions.less.lessOptions.modifyVars")]),e._v(" -> "),s("code",[e._v("css.preprocessorOptions.less.modifyVars")])]),e._v(" "),s("li",[e._v("with only "),s("code",[e._v("css.loaderOptions.sass")]),e._v(" option is set, it will be converted to "),s("code",[e._v("css.preprocessorOptions.sass")]),e._v(" and "),s("code",[e._v("css.preprocessorOptions.sass")]),e._v(".\nThe "),s("code",[e._v("sass")]),e._v(" configuration influence both "),s("code",[e._v("sass")]),e._v(" and "),s("code",[e._v("scss")]),e._v(" in Vue-CLI while vite need to configure them respectively")])])]),e._v(" "),s("li",[e._v("✅ V03: server options\n"),s("ul",[s("li",[s("code",[e._v("server.strictPort = false")]),e._v(" is set by default")]),e._v(" "),s("li",[s("code",[e._v("process.env.PORT")]),e._v(" or "),s("code",[e._v("devServer.port")]),e._v(" -> "),s("code",[e._v("server.port")])]),e._v(" "),s("li",[s("code",[e._v("process.env.DEV_HOST")]),e._v(" or "),s("code",[e._v("devServer.public")]),e._v(" or "),s("code",[e._v("devServer.host")]),e._v(" -> "),s("code",[e._v("server.host")]),e._v(", and convert "),s("code",[e._v("http://")]),e._v(" or "),s("code",[e._v("https://")]),e._v(" to "),s("code",[e._v("''")])]),e._v(" "),s("li",[s("code",[e._v("devServer.open")]),e._v(", "),s("code",[e._v("devServer.https")]),e._v(" -> "),s("code",[e._v("server.open")]),e._v(", "),s("code",[e._v("server.https")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("devServer.proxy")]),e._v(" -> "),s("code",[e._v("server.proxy")]),e._v(" is transformed in proxy configuration, we'll also "),s("code",[e._v("pathRewrite")]),e._v(" -> "),s("code",[e._v("rewrite")])])])]),e._v(" "),s("li",[e._v("✅ V04: build options\n"),s("ul",[s("li",[s("code",[e._v("outputDir")]),e._v(" -> "),s("code",[e._v("build.outDir")])]),e._v(" "),s("li",[s("code",[e._v("css.extract")]),e._v(" -> "),s("code",[e._v("build.cssCodeSplit")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("process.env.MODERN === 'true'")]),e._v(" is set, we'll also set "),s("code",[e._v("build.minify = esbuild")])]),e._v(" "),s("li",[s("code",[e._v("process.env.GENERATE_SOURCEMAP === 'true'")]),e._v(" or "),s("code",[e._v("vueConfig.productionSourceMap")]),e._v(" or "),s("code",[e._v("css.sourceMap")]),e._v(" -> "),s("code",[e._v("build.sourcemap")])])])]),e._v(" "),s("li",[e._v("✅ V05: "),s("code",[e._v("resolve.alias")]),e._v(" options\n"),s("ul",[s("li",[e._v("add alias options by default")])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("resolve"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'/^~/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("ul",[s("li",[e._v("webpack alias options will be converted to match format above")])])]),e._v(" "),s("li",[e._v("✅ V06: client-side env variables\n"),s("ul",[s("li",[e._v("extract variable names in jsp scriptlet tags")]),e._v(" "),s("li",[s("code",[e._v("VUE_APP_VARIABLE")]),e._v(" -> "),s("code",[e._v("process.env['VUE_APP_VARIABLE']")])])])]),e._v(" "),s("li",[e._v("✅ V07: css automatic imports\n"),s("ul",[s("li",[e._v("if 'style-resources-loader' is used to load css processor resources, the "),s("code",[e._v("pluginOptions.'style-resources-loader'")]),e._v(". Configurations will be transformed and written to "),s("code",[e._v("css.preprocessorOptions")])])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("pluginOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'style-resources-loader'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    preProcessor"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    patterns"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src/styles/var.less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src/styles/mixin.less'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("css"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  preprocessorOptions"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    less"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      additionalData"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('@import "src/styles/var.less";@import "src/styles/mixin.less";')]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[e._v("`")])]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])]),e._v(" "),s("h3",{attrs:{id:"webpack-conversion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack-conversion"}},[e._v("#")]),e._v(" Webpack conversion")]),e._v(" "),s("blockquote",[s("p",[e._v("Webpack conversion is based on "),s("code",[e._v("webpack.config.js")]),e._v(" or "),s("code",[e._v("webpack.base.js/webpack.dev.js/webpack.prod.js")]),e._v(" or "),s("code",[e._v("webpack.build.js/webpack.production.js")]),e._v(", map configuration to "),s("code",[e._v("vite.config.js")])])]),e._v(" "),s("blockquote",[s("p",[e._v("Note: if you are not using configuration files above, you need to convert configurations manually")])]),e._v(" "),s("ul",[s("li",[e._v("✅ W01: build entry options\n"),s("ul",[s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("string")]),e._v(" type: "),s("code",[e._v("entry")]),e._v(" -> "),s("code",[e._v("build.rollupOptions.input")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("object")]),e._v(" type: the properties of "),s("code",[e._v("entry")]),e._v(" will be converted set to "),s("code",[e._v("build.rollupOptions.input")])]),e._v(" "),s("li",[e._v("if "),s("code",[e._v("entry")]),e._v(" is "),s("code",[e._v("function")]),e._v(" type: execute result of "),s("code",[e._v("entry")]),e._v(" will be set to "),s("code",[e._v("build.rollupOptions.input")])])])]),e._v(" "),s("li",[e._v("✅ W02: "),s("code",[e._v("outDir")]),e._v(" options\n"),s("ul",[s("li",[s("code",[e._v("output.path")]),e._v(" -> "),s("code",[e._v("build.outDir")])])])]),e._v(" "),s("li",[e._v("✅ W03: "),s("code",[e._v("resolve.alias")]),e._v(" options\n"),s("ul",[s("li",[e._v("add alias options by default")])]),e._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("resolve"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" find"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" replacement"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("ul",[s("li",[e._v("webpack alias options will also be converted to match the configuration above")]),e._v(" "),s("li",[e._v("for "),s("code",[e._v("resolve.alias")]),e._v(" configurations trailing with "),s("code",[e._v("$")]),e._v(", we'll remove the trailing '$' and set an accurate value")])])]),e._v(" "),s("li",[e._v("✅ W04: server options\n"),s("ul",[s("li",[s("code",[e._v("devServer.host")]),e._v(", "),s("code",[e._v("devServer.port")]),e._v(", "),s("code",[e._v("devServer.proxy")]),e._v(", "),s("code",[e._v("devServer.https")]),e._v(", "),s("code",[e._v("devServer.contentBase")]),e._v(" -> "),s("code",[e._v("server.host")]),e._v(", "),s("code",[e._v("server.port")]),e._v(", "),s("code",[e._v("server.proxy")]),e._v(", "),s("code",[e._v("server.https")]),e._v(", "),s("code",[e._v("server.base")])])])]),e._v(" "),s("li",[e._v("✅ W05: define options\n"),s("ul",[s("li",[s("code",[e._v("new webpack.DefinePlugin()")]),e._v(" -> "),s("code",[e._v("define")])])])])]),e._v(" "),s("h3",{attrs:{id:"others"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#others"}},[e._v("#")]),e._v(" Others")]),e._v(" "),s("ul",[s("li",[e._v("⚠️ O01: for CommonJS syntax, e.g. "),s("code",[e._v("require('./')")]),e._v(" "),s("ul",[s("li",[e._v("you can use vite plugin "),s("code",[e._v("@originjs/vite-plugin-commonjs")]),e._v(", see also "),s("a",{attrs:{href:"https://github.com/originjs/vite-plugins/tree/main/packages/vite-plugin-commonjs",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".\nPlease note that the plugin only supports part of CommonJS syntax. That means some syntax is not supported. You need to covert them to ES Modules syntax manually")])])]),e._v(" "),s("li",[e._v("❌ O02: for "),s("code",[e._v("Element-UI")]),e._v(", see also "),s("a",{attrs:{href:"https://github.com/vitejs/vite/issues/3370",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v(" [vite] Uncaught TypeError: Cannot read property '$isServer' of undefined\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/dom.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1189)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/popup/popup-manager.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1478)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/popup/index.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:1701)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at node_modules/_element-ui@2.15.1@element-ui/lib/utils/vue-popper.js (:8080/node_modules/.vite/element-ui.js?v=675d2c77:2546)\n  at __require (:8080/node_modules/.vite/chunk-6VNJZP5B.js?v=675d2c77:12)\n  at Object.5 (:8080/node_modules/.vite/element-ui.js?v=675d2c77:6861)\n  at __webpack_require__ (:8080/node_modules/.vite/element-ui.js?v=675d2c77:6547)\n")])])])]),e._v(" "),s("li",[e._v("⚠️ O03: imports that containing multiple alias like: "),s("code",[e._v("@import '~@/styles/global.scss'")]),e._v(", which includes alias "),s("code",[e._v("~")]),e._v(" and "),s("code",[e._v("@")]),e._v(" at the same time\n"),s("ul",[s("li",[e._v("you can add an alias "),s("code",[e._v("{ find: /^~@/, replacement: path.resolve(__dirname, 'src') }")]),e._v(" to "),s("code",[e._v("resolve.alias")]),e._v(" options, and place it as the first alias configuration")])])]),e._v(" "),s("li",[e._v("⚠️ O04: for "),s("code",[e._v("jsx")]),e._v(" syntax in "),s("code",[e._v(".vue")]),e._v(" file\n"),s("ul",[s("li",[e._v("you need to enable "),s("code",[e._v("jsx")]),e._v(" support : In Vue2, add plugin "),s("code",[e._v("vite-plugin-vue2")]),e._v(" and set "),s("code",[e._v("{ jsx: true }")]),e._v(" option. In Vue3, add plugin "),s("code",[e._v("@vitejs/plugin-vue-jsx")])]),e._v(" "),s("li",[e._v("you also need to add attribute "),s("code",[e._v('lang="jsx"')]),e._v(" to "),s("code",[e._v("script")]),e._v(" label if jsx syntax is used, e.g. "),s("code",[e._v('<script lang="jsx"><\/script>')])]),e._v(" "),s("li",[e._v("If you encountered the following error")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('3:54:29 PM [vite] Internal server error: /Users/Chieffo/Documents/project/Vue-mmPlayer/src/base/mm-icon/mm-icon.vue?vue&type=script&lang.tsx: Duplicate declaration "h" (This is an error on an internal node. Probably an internal error.)\nPlugin: vite-plugin-vue2\nFile: /Users/Chieffo/Documents/project/Vue-mmPlayer/src/base/mm-icon/mm-icon.vue?vue&type=script&lang.tsx\n    at File.buildCodeFrameError (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/core/lib/transformation/file/file.js:244:12)\n    at Scope.checkBlockScopedCollisions (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:421:22)\n    at Scope.registerBinding (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:581:16)\n    at Scope.registerDeclaration (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:523:14)\n    at Object.BlockScoped (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/scope/index.js:240:12)\n    at Object.newFn (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/visitors.js:212:17)\n    at NodePath._call (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:53:20)\n    at NodePath.call (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:36:14)\n    at NodePath.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:90:31)\n    at TraversalContext.visitQueue (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:99:16)\n    at TraversalContext.visitMultiple (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:68:17)\n    at TraversalContext.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:125:19)\n    at Function.traverse.node (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/index.js:76:17)\n    at NodePath.visit (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/path/context.js:97:18)\n    at TraversalContext.visitQueue (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:99:16)\n    at TraversalContext.visitSingle (/Users/Chieffo/Documents/project/Vue-mmPlayer/node_modules/@babel/traverse/lib/context.js:73:19)\n')])])]),e._v("you can try to update configuration of "),s("code",[e._v("babel.config.js")]),e._v(" like this :"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  presets"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@vue/app'")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[e._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  presets"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@vue/babel-preset-jsx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),e._v("see also "),s("a",{attrs:{href:"https://vuejs.org/v2/guide/render-function.html#JSX",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("⚠️ O05: for webpack syntax "),s("code",[e._v("require.context")]),e._v(" "),s("ul",[s("li",[e._v("add vite plugin "),s("code",[e._v("@originjs/vite-plugin-require-context")]),e._v(", see also "),s("a",{attrs:{href:"https://github.com/originjs/vite-plugins/tree/main/packages/vite-plugin-require-context",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1)])])]),e._v(" "),s("li",[e._v("✅ O06: we have fixed the error "),s("code",[e._v('Compiling error when the template of the .vue file has the attribute lang="html"')]),e._v(" "),s("ul",[s("li",[e._v("we will remove "),s("code",[e._v('lang="html"')]),e._v(" attribute from "),s("code",[e._v("template")]),e._v(" label by default, see also "),s("a",{attrs:{href:"https://github.com/vuejs/vue-loader/issues/1443",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1)])])]),e._v(" "),s("li",[e._v("❌ O07: webpack syntax "),s("code",[e._v("require.ensure")]),e._v(" is not supported")]),e._v(" "),s("li",[e._v("⚠️ O08: you need to convert "),s("code",[e._v("dynamic imports")]),e._v(" that include alias to "),s("code",[e._v("absolute paths")]),e._v(" or "),s("code",[e._v("relative paths")]),e._v(" like the followings, see also "),s("a",{attrs:{href:"https://github.com/rollup/plugins/tree/master/packages/dynamic-import-vars#limitations",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@/components/views/test.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),e._v("->"),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./components/views/test.vue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])])])])])}),[],!1,null,null,null);t.default=n.exports}}]);